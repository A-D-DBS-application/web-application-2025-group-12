<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GroundMatch</title>
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='images/favicon.svg') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/global.css') }}">
</head>
<body>
    {% set auth_endpoints = ['company_login', 'client_login', 'company_register', 'home'] %}
    
    {% if request.endpoint in auth_endpoints %}
    {# Centered logo navbar for auth-related pages (home, login, register) #}
    <header class="gm-navbar">
        <div class="gm-container gm-navbar-inner gm-navbar-centered">
            <a class="gm-brand" href="{{ url_for('home') }}">
                <img src="{{ url_for('static', filename='images/logo-full.svg') }}" alt="GroundMatch" class="gm-logo-full">
            </a>
        </div>
    </header>
    {% else %}
    {# Full navbar with navigation links for authenticated pages #}
    <header class="gm-navbar">
        <div class="gm-container gm-navbar-inner">
            <a class="gm-brand" href="{{ url_for('dashboard') if session.role == 'company' else url_for('client_dashboard') }}">
                <img src="{{ url_for('static', filename='images/logo-full.svg') }}" alt="GroundMatch" class="gm-logo-full">
            </a>

            {# Mobile hamburger menu toggle #}
            <input type="checkbox" id="mobile-menu-toggle" class="mobile-menu-checkbox">
            <label for="mobile-menu-toggle" class="mobile-menu-icon">
                <span></span>
                <span></span>
                <span></span>
            </label>

            {# Desktop navigation #}
            <nav class="gm-nav gm-nav-desktop">
                <a href="{{ url_for('dashboard') if session.role == 'company' else url_for('client_dashboard') }}" class="gm-nav-link {% if request.path.startswith('/dashboard') or request.path.startswith('/client/dashboard') or request.path == '/' %}active{% endif %}">
                    <img src="{{ url_for('static', filename='images/nav/home-white.svg') }}" class="gm-nav-icon" alt="">
                    <span>Home</span>
                </a>
                {% if session.role == 'company' %}
                <a href="{{ url_for('clients_list') }}" class="gm-nav-link {% if request.path.startswith('/clients') %}active{% endif %}">
                    <img src="{{ url_for('static', filename='images/nav/clients-white.svg') }}" class="gm-nav-icon" alt="">
                    <span>Clients</span>
                </a>
                {% endif %}
                <a href="{{ url_for('preferences_list') }}" class="gm-nav-link {% if request.path.startswith('/preferences') %}active{% endif %}">
                    <img src="{{ url_for('static', filename='images/nav/prefs-white.svg') }}" class="gm-nav-icon" alt="">
                    <span>Preferences</span>
                </a>
                {% if session.role == 'company' %}
                <a href="{{ url_for('grounds_list') }}" class="gm-nav-link {% if request.path.startswith('/grounds') %}active{% endif %}">
                    <img src="{{ url_for('static', filename='images/nav/building-plot-white.svg') }}" class="gm-nav-icon" alt="">
                    <span>Building Plots</span>
                </a>
                {% endif %}
                <a href="{{ url_for('matches_list') }}" class="gm-nav-link {% if request.path.startswith('/matches') %}active{% endif %}">
                    <img src="{{ url_for('static', filename='images/nav/matches-white.svg') }}" class="gm-nav-icon" alt="">
                    <span>Matches</span>
                </a>
                {% if session.role == 'company' %}
                <a href="{{ url_for('company_profile') }}" class="gm-user-pill gm-user-link">{{ current_user_name }}</a>
                {% elif session.role == 'client' %}
                <a href="{{ url_for('client_profile') }}" class="gm-user-pill gm-user-link">{{ current_user_name }}</a>
                {% endif %}
                <a href="{{ url_for('logout') }}" class="gm-nav-link gm-nav-cta">
                    <img src="{{ url_for('static', filename='images/nav/logout-white.svg') }}" class="gm-nav-icon" alt="">
                    <span>Logout</span>
                </a>
            </nav>

            {# Mobile navigation menu #}
            <nav class="gm-nav gm-nav-mobile">
                <a href="{{ url_for('dashboard') if session.role == 'company' else url_for('client_dashboard') }}" class="gm-nav-mobile-link {% if request.path.startswith('/dashboard') or request.path.startswith('/client/dashboard') or request.path == '/' %}active{% endif %}">
                    <span>Home</span>
                </a>
                {% if session.role == 'company' %}
                <a href="{{ url_for('clients_list') }}" class="gm-nav-mobile-link {% if request.path.startswith('/clients') %}active{% endif %}">
                    <span>Clients</span>
                </a>
                {% endif %}
                <a href="{{ url_for('preferences_list') }}" class="gm-nav-mobile-link {% if request.path.startswith('/preferences') %}active{% endif %}">
                    <span>Preferences</span>
                </a>
                {% if session.role == 'company' %}
                <a href="{{ url_for('grounds_list') }}" class="gm-nav-mobile-link {% if request.path.startswith('/grounds') %}active{% endif %}">
                    <span>Building Plots</span>
                </a>
                {% endif %}
                <a href="{{ url_for('matches_list') }}" class="gm-nav-mobile-link {% if request.path.startswith('/matches') %}active{% endif %}">
                    <span>Matches</span>
                </a>
                <div class="gm-nav-mobile-user">
                    {% if session.role == 'company' %}
                    <a href="{{ url_for('company_profile') }}" class="gm-nav-mobile-link">
                        <strong>{{ current_user_name }}</strong>
                    </a>
                    {% elif session.role == 'client' %}
                    <a href="{{ url_for('client_profile') }}" class="gm-nav-mobile-link">
                        <strong>{{ current_user_name }}</strong>
                    </a>
                    {% endif %}
                </div>
                <a href="{{ url_for('logout') }}" class="gm-nav-mobile-link gm-nav-mobile-logout">
                    <span>Logout</span>
                </a>
            </nav>
        </div>
    </header>
    {% endif %}

    <main class="gm-container gm-main">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="gm-flash-wrap">
                    {% for category, message in messages %}
                        <div class="gm-flash gm-flash-{{ category }}">{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </main>

    <footer class="gm-footer">
        <div class="gm-container">
            {% if session.role == 'client' and client is defined and client.company %}
            <div class="gm-footer-company-info">
                <strong>Company Contact Information:</strong><br>
                <small>Email: {{ client.company.email or 'Not available' }}</small>
            </div>
            {% endif %}
            <small>© {{ current_year if (current_year is defined) else '' }} GroundMatch — MVP</small>
        </div>
    </footer>

</body>
</html>

