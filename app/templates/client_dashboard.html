{% extends "base.html" %}
{% block content %}
<h1>Client Dashboard - {{ client.name }}</h1>

<div class="card">
    <h2>Your Preferences</h2>
    {% if preferences %}
    <p><strong>Location:</strong> {{ preferences.location or 'Not set' }}</p>
    <p><strong>Budget:</strong> €{{ preferences.min_budget|format_price if preferences.min_budget else '?' }} - €{{ preferences.max_budget|format_price if preferences.max_budget else '?' }}</p>
    <p><strong>Size:</strong> {{ preferences.min_m2|format_number }} - {{ preferences.max_m2|format_number }} m²</p>
    <p><strong>Subdivision Type:</strong> {{ (preferences.subdivision_type.replace('_', ' ').title()) if preferences.subdivision_type else 'Not set' }}</p>
    <a href="{{ url_for('client_preferences_edit') }}" class="btn">Edit Preferences</a>
    {% else %}
    <p>No preferences set yet.</p>
    <a href="{{ url_for('client_preferences_edit') }}" class="btn btn-success">Set Preferences</a>
    {% endif %}
</div>

<div class="card">
    <h2>Your Matches ({{ matches|length }})</h2>
    {% if matches %}
        <table>
            <thead>
                <tr>
                    <th>Location</th>
                    <th>Surface Area (m²)</th>
                    <th>Budget</th>
                    <th>Subdivision Type</th>
                    <th>Owner</th>
                    <th>Total Score</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for match in matches %}
                <tr>
                        <td>{{ match.ground.location }}</td>
                        <td>{{ match.ground.m2|format_number }} m²</td>
                        <td>€{{ match.ground.budget|format_price }}</td>
                        <td>{{ match.ground.subdivision_type.replace('_', ' ').title() }}</td>
                        <td>{{ match.ground.owner }}</td>
                        <td><strong>{{ match|match_percent }}%</strong></td>
                        <td>{{ match.status|status_badge }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
    <p>No matches yet. Ask your company to run the matching algorithm.</p>
    {% endif %}
</div>

<div class="card">
    <h2>Quick Links</h2>
    <a href="{{ url_for('matches_list') }}" class="btn">View All My Matches</a>
    <a href="{{ url_for('client_preferences_edit') }}" class="btn">Update My Preferences</a>
</div>
{% endblock %}
