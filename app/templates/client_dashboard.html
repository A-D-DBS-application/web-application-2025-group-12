{% extends "base.html" %}
{% block content %}
<h1>Client Dashboard - {{ client.name }}</h1>

<div class="card">
    <h2>Your Preferences</h2>
    {% if preferences %}
    <p><strong>Location:</strong> {{ preferences.location or 'Not set' }}</p>
    <p><strong>Budget:</strong> €{{ preferences.min_budget|format_price if preferences.min_budget else '?' }} - €{{ preferences.max_budget|format_price if preferences.max_budget else '?' }}</p>
    <p><strong>Size:</strong> {{ preferences.min_m2|format_number }} - {{ preferences.max_m2|format_number }} m²</p>
    <p><strong>Subdivision Type:</strong> {{ (preferences.subdivision_type.replace('_', ' ').title()) if preferences.subdivision_type else 'Not set' }}</p>
    <a href="{{ url_for('client_preferences_edit') }}" class="btn">Edit Preferences</a>
    {% else %}
    <p>No preferences set yet.</p>
    <a href="{{ url_for('client_preferences_edit') }}" class="btn btn-success">Set Preferences</a>
    {% endif %}
</div>

<div class="card">
    <h2>Your Matches ({{ matches|length }})</h2>
    {% if matches %}
        <div class="client-matches-grid">
            {% for match in matches %}
            <div class="client-match-card">
                <div class="client-match-image-container">
                    <img src="{% if match.ground.photo_url %}{{ match.ground.photo_url }}{% elif match.ground.image_url %}{{ match.ground.image_url }}{% else %}{{ url_for('ground_image', ground_id=match.ground.id) }}{% endif %}" alt="{{ match.ground.location }}" class="client-match-image">
                </div>
                <div class="client-match-info">
                    <div class="client-match-location">{{ match.ground.location }}</div>
                    <div class="client-match-meta">
                        <div class="meta-item">{{ match.ground.m2|format_number }} m²</div>
                        <div class="meta-item">€{{ match.ground.budget|format_price }}</div>
                    </div>
                    <div class="client-match-meta-secondary">
                        <div class="meta-item">{{ match.ground.subdivision_type.replace('_', ' ').title() }}</div>
                        <div class="meta-item">{{ match.ground.owner }}</div>
                    </div>
                    <div class="client-match-score">
                        <strong>Score: {{ match|match_percent }}%</strong>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
    <p>No matches yet. Ask your company to run the matching algorithm.</p>
    {% endif %}
</div>

<div class="card">
    <h2>Quick Links</h2>
    <a href="{{ url_for('matches_list') }}" class="btn">View All My Matches</a>
    <a href="{{ url_for('client_preferences_edit') }}" class="btn">Update My Preferences</a>
</div>
{% endblock %}
