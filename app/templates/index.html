<!-- Landing page assumes separate Flask auth routes for login/register; both forms submit company_name for Supabase auth. -->
{% extends 'base.html' %}

{% block title %}GroundMatch â€¢ Broker Login{% endblock %}

{% block content %}
{% set default_mode = 'login' if auth_mode == 'login' else 'register' %}

<section class="auth-hero stack">
  <div class="hero-icon" aria-hidden="true">
    <i class="bi bi-geo-alt"></i>
  </div>
  <p class="text-muted">Welcome to GroundMatch</p>
  <h1>Connect your clients with the perfect building plots.</h1>
  <p class="hero-subtitle">Streamline your construction business with intelligent matching.</p>
</section>

<section class="auth-layout">
  <div class="auth-photo">
    <img src="https://images.unsplash.com/photo-1465804575741-338df8554e02?auto=format&fit=crop&w=1200&q=80" alt="Building site with crane" loading="lazy">
  </div>
  <div class="card auth-panel">
    <p class="text-muted" style="font-weight:600;">Get Started</p>
    <p class="text-muted">Login to your account or create a new one</p>
    <div class="auth-toggle" role="tablist">
      <button class="auth-toggle__tab {{ 'is-active' if default_mode == 'register' else '' }}" type="button" data-mode="register" role="tab" aria-selected="{{ 'true' if default_mode == 'register' else 'false' }}">Register</button>
      <button class="auth-toggle__tab {{ 'is-active' if default_mode == 'login' else '' }}" type="button" data-mode="login" role="tab" aria-selected="{{ 'true' if default_mode == 'login' else 'false' }}">Login</button>
    </div>

    <form class="stack auth-form {{ 'is-active' if default_mode == 'register' else '' }}" data-mode="register" method="post" action="{{ url_for('main.register') }}">
      <!-- csrf token placeholder -->
      <label for="company_username">Company Username</label>
      <input class="input" type="text" id="company_username" name="company_name" placeholder="Choose a username" required>
      <p class="text-muted">Create a username for your company account</p>
      <button class="btn btn-primary" type="submit">Create Account</button>
    </form>

    <form class="stack auth-form {{ 'is-active' if default_mode == 'login' else '' }}" data-mode="login" method="post" action="{{ url_for('main.login') }}">
      <!-- csrf token placeholder -->
      <label for="company_username_login">Company Username</label>
      <input class="input" type="text" id="company_username_login" name="company_name" placeholder="Enter your username" required>
      <p class="text-muted">Login with your existing account</p>
      <button class="btn btn-outline" type="submit">Login</button>
    </form>
  </div>
</section>

<section class="feature-cards grid">
  <article class="card feature-card">
    <div class="feature-icon"><i class="bi bi-people"></i></div>
    <h3>Manage Clients</h3>
    <p>Keep track of every client and their building preferences in one place.</p>
  </article>
  <article class="card feature-card">
    <div class="feature-icon"><i class="bi bi-geo"></i></div>
    <h3>Browse Plots</h3>
    <p>Search through available building plots with detailed specifications.</p>
  </article>
  <article class="card feature-card">
    <div class="feature-icon"><i class="bi bi-graph-up-arrow"></i></div>
    <h3>Smart Matching</h3>
    <p>Get intelligent matches based on client preferences and plot data.</p>
  </article>
</section>
{% endblock %}

{% block scripts %}
<script>
  const toggleTabs = document.querySelectorAll(".auth-toggle__tab");
  const authForms = document.querySelectorAll(".auth-form");

  toggleTabs.forEach(tab => {
    tab.addEventListener("click", () => {
      const mode = tab.dataset.mode;
      toggleTabs.forEach(t => t.classList.toggle("is-active", t === tab));
      toggleTabs.forEach(t => t.setAttribute("aria-selected", t === tab ? "true" : "false"));
      authForms.forEach(form => form.classList.toggle("is-active", form.dataset.mode === mode));
    });
  });
</script>
{% endblock %}
