{% extends "base.html" %}
{% block content %}
<section class="stack">
  <header class="page-header">
    <div>
      <a class="text-muted" href="{{ url_for('main.manage_clients') }}">&larr; Back to clients</a>
      <h1>{{ 'Edit Preferences' if preferences else 'Add Preferences' }} for {{ client.name }}</h1>
      <p class="text-muted">Configure search settings for this client.</p>
    </div>
  </header>

  <article class="profile-card">
    <form class="stack" method="POST">
      <div class="preference-grid">
        <div class="stack">
          <label for="pref_location">Location</label>
          <input class="input" id="pref_location" type="text" name="location" value="{{ preferences.location if preferences else '' }}">
        </div>
        <div class="stack">
          <label for="pref_soil">Soil Type</label>
          <select class="select" id="pref_soil" name="soil">
            {% set soil_val = preferences.soil if preferences else '' %}
            <option value="" {% if not soil_val %}selected{% endif %}>No preference</option>
            {% for soil in ['Clay', 'Sand', 'Loam'] %}
              <option value="{{ soil.lower() }}" {% if soil_val and soil_val|lower == soil|lower %}selected{% endif %}>{{ soil }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="stack">
          <label for="pref_type">Subdivision Type</label>
          <input class="input" id="pref_type" type="text" name="subdivision_type" value="{{ preferences.subdivision_type if preferences else '' }}" placeholder="Residential, Mixed-use">
        </div>
      </div>

      <div class="preference-grid">
        <div class="stack">
          <label>Surface Area Range (m²)</label>
          <div class="preference-summary">
            <p>Minimum</p>
            <input class="input" type="number" min="0" name="min_m2" value="{{ preferences.min_m2 if preferences else '' }}">
            <p>Maximum</p>
            <input class="input" type="number" min="0" name="max_m2" value="{{ preferences.max_m2 if preferences else '' }}">
          </div>
        </div>
        <div class="stack">
          <label>Budget Range (€)</label>
          <div class="preference-summary">
            <p>Minimum</p>
            <input class="input" type="number" min="0" step="0.01" name="min_budget" value="{{ preferences.min_budget if preferences else '' }}">
            <p>Maximum</p>
            <input class="input" type="number" min="0" step="0.01" name="max_budget" value="{{ preferences.max_budget if preferences else '' }}">
          </div>
        </div>
      </div>

      <div class="action-row">
        <a class="btn btn-outline" href="{{ url_for('main.manage_clients') }}">Cancel</a>
        <button class="btn btn-primary" type="submit">{{ 'Save Preferences' if preferences else 'Add Preferences' }}</button>
      </div>
    </form>
  </article>
</section>
{% endblock %}
